- id: everyones_arriving
  alias: Everyone is Arriving
  description: Turn on things when people are arriving
  trigger:
    platform: state
    entity_id: group.family
    from: 'not_home'
    to: 'home'
  action:
    - wait_template: "{{ is_state('binary_sensor.front_door_sensor_contact', 'on') }}"
      timeout: '00:30:00'
      continue_on_timeout: false
    - service: fan.turn_on
      entity_id: all
    # TODO: TESTING THIS. Should turn on lights, tv, etc
    - service: notify.denys
      data_template:
        title: '–í—ñ—Ç–∞—é –≤–¥–æ–º–∞ üéâ'
        message: "–í–º–∏–∫–∞—é —Å–≤—ñ—Ç–ª–æ, —Ç–µ–ª–µ–≤—ñ–∑–æ—Ä, –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∏ —Ç–∞ —ñ–Ω—à—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó‚Ä¶"

- id: everyones_leaving
  alias: Everyone is Leaving
  description: Turn off things when people are leaving
  trigger:
    platform: state
    entity_id: group.family
    from: 'home'
    to: 'not_home'
    for: '00:10:00'
  action:
    - service: fan.turn_off
      entity_id: all
    - service: light.turn_off
      entity_id: all
    - service: media_player.turn_off
      entity_id: all
