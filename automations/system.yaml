- id: home_assistant_release_notification
  alias: Home Assistant Release notification
  trigger:
    - platform: state
      entity_id: binary_sensor.updater
  action:
    service: notify.denys
    data:
      title: '–û–Ω–æ–≤–ª–µ–Ω–Ω—è Home Assistant üéâ'
      message: "–î–æ—Å—Ç—É–ø–Ω–∞ –Ω–æ–≤–∞ –≤–µ—Ä—Å—ñ—è Home Assistant {{ state_attr('binary_sensor.updater', 'newest_version') }}."
      data:
        url: /hassio/dashboard

- id: open_uv_index_update
  alias: Update OpenUV
  description: Update OpenUV every hour only when sun is above horizon
  mode: single
  trigger:
    platform: time_pattern
    hours: /1
  condition:
    # Check only when sun is above horizon and not more than once per 59 minutes
    - condition: state
      entity_id: sun.sun
      state: 'above_horizon'
  action:
    - service: openuv.update_uv_index_data
    - delay:
        minutes: 50

- id: aqi_warning
  alias: AQI Warning Notification
  trigger:
    - platform: numeric_state
      entity_id: sensor.nyvky_aqi
      above: 150
      below: 200
    - platform: numeric_state
      entity_id: sensor.nyvky_aqi
      above: 201
      below: 300
    - platform: numeric_state
      entity_id: sensor.nyvky_aqi
      above: 301
  action:
    - choose:
        - conditions:
            - condition: numeric_state
              entity_id: sensor.nyvky_aqi
              above: 150
              below: 200
          sequence:
            - service: script.announcement
              data:
                speak: false
                title: '–®–∫—ñ–¥–ª–∏–≤–µ –ø–æ–≤—ñ—Ç—Ä—è ü•¥'
                messages:
                  - "–®–∫—ñ–¥–ª–∏–≤–∏–π —Ä—ñ–≤–µ–Ω—å —è–∫–æ—Å—Ç—ñ –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
                  - "–û–±–µ—Ä–µ–∂–Ω–æ! –ù–∞–¥–≤–æ—Ä—ñ —à–∫—ñ–¥–ª–∏–≤–µ –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
                  - "–®–∫—ñ–¥–ª–∏–≤–µ –ø–æ–≤—ñ—Ç—Ä—è –Ω–∞–¥–≤–æ—Ä—ñ: {{ states('sensor.nyvky_aqi') | int }} AQI"
                notify_data:
                  url: /lovelace/home
        - conditions:
            - condition: numeric_state
              entity_id: sensor.nyvky_aqi
              above: 201
              below: 300
          sequence:
            - service: script.announcement
              data:
                speak: false
                title: '–î—É–∂–µ —à–∫—ñ–¥–ª–∏–≤–µ –ø–æ–≤—ñ—Ç—Ä—è üò∑'
                messages:
                  - "–î—É–∂–µ —à–∫—ñ–¥–ª–∏–≤–∏–π —Ä—ñ–≤–µ–Ω—å —è–∫–æ—Å—Ç—ñ –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
                  - "–û–±–µ—Ä–µ–∂–Ω–æ! –ù–∞–¥–≤–æ—Ä—ñ –¥—É–∂–µ —à–∫—ñ–¥–ª–∏–≤–µ –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
                  - "–î—É–∂–µ —à–∫—ñ–¥–ª–∏–≤–µ –ø–æ–≤—ñ—Ç—Ä—è –Ω–∞–¥–≤–æ—Ä—ñ: {{ states('sensor.nyvky_aqi') | int }} AQI"
                notify_data:
                  url: /lovelace/home
        - conditions:
            - condition: numeric_state
              entity_id: sensor.nyvky_aqi
              above: 301
          sequence:
            - service: script.announcement
              data:
                speak: false
                title: '–ù–µ–±–µ–∑–ø–µ—á–Ω–µ –ø–æ–≤—ñ—Ç—Ä—è ‚ò†Ô∏è'
                messages:
                  - "–ù–µ–±–µ–∑–ø–µ—á–Ω–∏–π —Ä—ñ–≤–µ–Ω—å —è–∫–æ—Å—Ç—ñ –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
                  - "–û–±–µ—Ä–µ–∂–Ω–æ! –ù–∞–¥–≤–æ—Ä—ñ –Ω–µ–±–µ–∑–ø–µ—á–Ω–µ –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
                  - "–ù–µ–±–µ–∑–ø–µ—á–Ω–µ –ø–æ–≤—ñ—Ç—Ä—è –Ω–∞–¥–≤–æ—Ä—ñ: {{ states('sensor.nyvky_aqi') | int }} AQI"
                notify_data:
                  url: /lovelace/home
      default:
        - service: script.announcement
          data:
            speak: false
            title: '–ü–æ–≤—ñ—Ç—Ä—è üå´'
            messages:
              - "–ü–æ–≥—ñ—Ä—à—É—î—Ç—å—Å—è —è–∫—ñ—Å—Ç—å –ø–æ–≤—ñ—Ç—Ä—è: {{ states('sensor.nyvky_aqi') | int }} AQI"
            notify_data:
              url: /lovelace/home

# Disabled because there's no transmission integration enabled right now.
- id: torrent_completed_notification
  alias: Notify about completed torrent
  initial_state: false
  trigger:
    platform: event
    event_type: transmission_downloaded_torrent
  action:
    - service: notify.all
      data:
        title: 'Transmission ‚¨áÔ∏è'
        message: '{{trigger.event.data.name}} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!'
