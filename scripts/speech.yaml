speak:
  alias: Make speach announcement on smart speaker
  fields:
    greetings:
      description: One of these greetings will be randomly picked for announcement
    messages:
      description: One of these messages will be randomly picked for announcement
  variables:
    announcement: >-
      {% if greetings and messages %}
        {{ (greetings | random) + ' ' + (messages | random) }}
      {% elif messages %}
        {{ (messages | random) }}
      {% else %}
        Немає тексту для озвучення.
      {% endif %}
  sequence:
    # Announce on speaker only when someone is home
    - choose:
      - conditions:
        - condition: state
          entity_id: group.family
          state: 'home'
        - condition: state
          entity_id: input_boolean.do_not_disturb
          state: 'off'
        sequence:
          - service: tts.google_say
            data:
              entity_id: media_player.google_home_mini
              message: "{{ announcement }}"

announcement:
  alias: Send a push-notification and make an announcement on smart speaker
  fields:
    title:
      description: A title for a push-notification
    greetings:
      description: One of these greetings will be randomly picked for announcement
    messages:
      description: One of these messages will be randomly picked for announcement
  variables:
    message: >-
      {% if greetings and messages %}
        {{ (greetings | random) ~ ' ' ~ (messages | random) }}
      {% elif messages %}
        {{ (messages | random) }}
      {% else %}
        Немає тексту для озвучення.
      {% endif %}
  sequence:
    - service: notify.all
      data:
        title: "{{ title }}"
        message: "{{ message }}"
    - service: script.speak
      data:
        message: "{{ message }}"

greeting:
  alias: Greet people upon their arrival
  variables:
    greeting: >-
      {{ [
        "Привіт!",
        "Вітаю!",
        "Вітаю вдома!",
        "Без вас було сумно!",
        "Ласкаво прошу додому!",
        "Нарешті ви вдома!",
        "Ви вдома!",
        "Хелоу, котики!",
        "Моя сім’я вдома!",
        "Мої котики вдома!",
        "Кошенята вдома!"
      ] | random }}
  sequence:
    - choose:
      - conditions:
          - condition: state
            entity_id: sun.sun
            state: 'above_horizon'
        sequence:
          - service: script.speak
            data:
              greetings:
                - "{{ greeting }}"
              messages:
                - "Як проходить ваш день?"
                - "Вдалого дня!"
                - "Ваш дім скучив за вами!"
                - "Немає місця, милішого за рідний дім."
                - "Люблю вас! Ви теж любіть один одного!"
                - "Що нового?"
                - "Як справи?"
      - conditions:
          - condition: state
            entity_id: sun.sun
            state: 'below_horizon'
        sequence:
          - service: script.speak
            data:
              greetings:
                - "{{ greeting }}"
              messages:
                - "Як пройшов ваш день?"
                - "Що нового?"
                - "Люблю вас! Ви теж любіть один одного!"
                - "Приємного і затишного вечора!"
                - "Затишного вечора!"
                - "Теплого вечора!"
                - "Приємного вечора!"
                - "Класного вечора!"
                - "Насолоджуйтесь вечором!"
                - "Поцілуйте один одного!"
                - "Не забудьте обійняти один одного!"
                - "Поділіться один з одним теплом"
                - "Що цікавого сталось сьогодні?"
                - "Що хорошого сталось за сьогодні?"
      default:
        - service: script.speak
          data:
            messages: "{{ greeting }}"
