announcement:
  alias: Send a push-notification and make an announcement on smart speaker
  fields:
    title:
      description: A title for a push-notification
    messages:
      description: One of these messages will be randomly picked for announcement
  variables:
    message: "{{ messages | random }}"
  sequence:
    - service: notify.denys
      data:
        title: "{{ title }}"
        message: "{{ message }}"
    # Announce on speaker only when someone is home
    - choose:
      - conditions:
        - condition: state
          entity_id: group.family
          state: 'home'
        - condition: state
          entity_id: binary_sensor.do_not_disturb
          state: 'off'
        sequence:
          - service: tts.google_say
            data:
              entity_id: media_player.google_home_mini
              message: "{{ message }}"
